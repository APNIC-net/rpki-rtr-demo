<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"> 
<!-- Generated by rfcdiff 1.45: rfcdiff  --> 
<!-- <!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional" > -->
<!-- System: Linux TomH-498551 6.1.0-38-amd64 #1 SMP PREEMPT_DYNAMIC Debian 6.1.147-1 (2025-08-02) x86_64 GNU/Linux --> 
<!-- Using awk: /usr/bin/gawk: GNU Awk 5.2.1, API 3.2, PMA Avon 8-g1, (GNU MPFR 4.2.0, GNU MP 6.2.1) --> 
<!-- Using diff: /usr/bin/diff: diff (GNU diffutils) 3.8 --> 
<!-- Using wdiff: /usr/bin/wdiff: wdiff (GNU wdiff) 1.2.2 --> 
<html xmlns="http://www.w3.org/1999/xhtml"> 
<head> 
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /> 
  <meta http-equiv="Content-Style-Type" content="text/css" /> 
  <title>Diff: draft-ietf-sidrops-8210bis-21.txt - draft-ietf-sidrops-8210bis.txt</title> 
  <style type="text/css"> 
    body    { margin: 0.4ex; margin-right: auto; } 
    tr      { } 
    td      { white-space: pre; font-family: monospace; vertical-align: top; font-size: 0.86em;} 
    th      { font-size: 0.86em; } 
    .small  { font-size: 0.6em; font-style: italic; font-family: Verdana, Helvetica, sans-serif; } 
    .left   { background-color: #EEE; } 
    .right  { background-color: #FFF; } 
    .diff   { background-color: #CCF; } 
    .lblock { background-color: #BFB; } 
    .rblock { background-color: #FF8; } 
    .insert { background-color: #8FF; } 
    .delete { background-color: #ACF; } 
    .void   { background-color: #FFB; } 
    .cont   { background-color: #EEE; } 
    .linebr { background-color: #AAA; } 
    .lineno { color: red; background-color: #FFF; font-size: 0.7em; text-align: right; padding: 0 2px; } 
    .elipsis{ background-color: #AAA; } 
    .left .cont { background-color: #DDD; } 
    .right .cont { background-color: #EEE; } 
    .lblock .cont { background-color: #9D9; } 
    .rblock .cont { background-color: #DD6; } 
    .insert .cont { background-color: #0DD; } 
    .delete .cont { background-color: #8AD; } 
    .stats, .stats td, .stats th { background-color: #EEE; padding: 2px 0; } 
    span.hide { display: none; color: #aaa;}    a:hover span { display: inline; }    tr.change { background-color: gray; } 
    tr.change a { text-decoration: none; color: black } 
  </style> 
     <script>
var chunk_index = 0;
var old_chunk = null;

function format_chunk(index) {
    var prefix = "diff";
    var str = index.toString();
    for (x=0; x<(4-str.length); ++x) {
        prefix+='0';
    }
    return prefix + str;
}

function find_chunk(n){
    return document.querySelector('tr[id$="' + n + '"]');
}

function change_chunk(offset) {
    var index = chunk_index + offset;
    var new_str;
    var new_chunk;

    new_str = format_chunk(index);
    new_chunk = find_chunk(new_str);
    if (!new_chunk) {
        return;
    }
    if (old_chunk) {
        old_chunk.style.outline = "";
    }
    old_chunk = new_chunk;
    old_chunk.style.outline = "1px solid red";
    window.location.hash = "#" + new_str;
    window.scrollBy(0,-100);
    chunk_index = index;
}

document.onkeydown = function(e) {
    switch (e.keyCode) {
    case 78:
        change_chunk(1);
        break;
    case 80:
        change_chunk(-1);
        break;
    }
};
   </script> 
</head> 
<body > 
  <table border="0" cellpadding="0" cellspacing="0"> 
  <tr id="part-1" bgcolor="orange"><th></th><th>&nbsp;draft-ietf-sidrops-8210bis-21.txt&nbsp;</th><th> </th><th>&nbsp;draft-ietf-sidrops-8210bis.txt&nbsp;</th><th></th></tr> 
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">Network Working Group                                            R. Bush</td><td> </td><td class="right">Network Working Group                                            R. Bush</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">Internet-Draft                               Arrcus, DRL, &amp; IIJ Research</td><td> </td><td class="right">Internet-Draft                               Arrcus, DRL, &amp; IIJ Research</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">Intended status: Standards Track                              R. Austein</td><td> </td><td class="right">Intended status: Standards Track                              R. Austein</td><td class="lineno"></td></tr>
      <tr id="diff0001"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">Expires: <span class="delete">15</span> February 2026                           Dragon Research Labs</td><td> </td><td class="rblock">Expires: <span class="insert">22</span> February 2026                           Dragon Research Labs</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">                                                          <span class="delete">14</span> August 2025</td><td> </td><td class="rblock">                                                          <span class="insert">21</span> August 2025</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   The Resource Public Key Infrastructure (RPKI) to Router Protocol,</td><td> </td><td class="right">   The Resource Public Key Infrastructure (RPKI) to Router Protocol,</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">                               Version 2</td><td> </td><td class="right">                               Version 2</td><td class="lineno"></td></tr>
      <tr id="diff0002"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">                     draft-ietf-sidrops-8210bis-2<span class="delete">1</span></td><td> </td><td class="rblock">                     draft-ietf-sidrops-8210bis-2<span class="insert">2</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">Abstract</td><td> </td><td class="right">Abstract</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   In order to validate the origin Autonomous Systems (ASes) and</td><td> </td><td class="right">   In order to validate the origin Autonomous Systems (ASes) and</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Autonomous System relationships behind BGP announcements, routers</td><td> </td><td class="right">   Autonomous System relationships behind BGP announcements, routers</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   need a simple but reliable mechanism to receive Resource Public Key</td><td> </td><td class="right">   need a simple but reliable mechanism to receive Resource Public Key</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Infrastructure (RFC6480) prefix origin data, Router Keys, and ASPA</td><td> </td><td class="right">   Infrastructure (RFC6480) prefix origin data, Router Keys, and ASPA</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   data from a trusted cache.  This document describes a protocol to</td><td> </td><td class="right">   data from a trusted cache.  This document describes a protocol to</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   deliver them.</td><td> </td><td class="right">   deliver them.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="part-2" class="change" ><td></td><th><small>skipping to change at</small><a href="#part-2"><em> page 1, line 41<span class="hide"> &para;</span></em></a></th><th> </th><th><small>skipping to change at</small><a href="#part-2"><em> page 1, line 41<span class="hide"> &para;</span></em></a></th><td></td></tr>
      <tr><td class="lineno"></td><td class="left">   Internet-Drafts are working documents of the Internet Engineering</td><td> </td><td class="right">   Internet-Drafts are working documents of the Internet Engineering</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Task Force (IETF).  Note that other groups may also distribute</td><td> </td><td class="right">   Task Force (IETF).  Note that other groups may also distribute</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   working documents as Internet-Drafts.  The list of current Internet-</td><td> </td><td class="right">   working documents as Internet-Drafts.  The list of current Internet-</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Drafts is at https://datatracker.ietf.org/drafts/current/.</td><td> </td><td class="right">   Drafts is at https://datatracker.ietf.org/drafts/current/.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Internet-Drafts are draft documents valid for a maximum of six months</td><td> </td><td class="right">   Internet-Drafts are draft documents valid for a maximum of six months</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   and may be updated, replaced, or obsoleted by other documents at any</td><td> </td><td class="right">   and may be updated, replaced, or obsoleted by other documents at any</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   time.  It is inappropriate to use Internet-Drafts as reference</td><td> </td><td class="right">   time.  It is inappropriate to use Internet-Drafts as reference</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   material or to cite them other than as "work in progress."</td><td> </td><td class="right">   material or to cite them other than as "work in progress."</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0003"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   This Internet-Draft will expire on <span class="delete">15</span> February 2026.</td><td> </td><td class="rblock">   This Internet-Draft will expire on <span class="insert">22</span> February 2026.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">Copyright Notice</td><td> </td><td class="right">Copyright Notice</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Copyright (c) 2025 IETF Trust and the persons identified as the</td><td> </td><td class="right">   Copyright (c) 2025 IETF Trust and the persons identified as the</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   document authors.  All rights reserved.</td><td> </td><td class="right">   document authors.  All rights reserved.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   This document is subject to BCP 78 and the IETF Trust's Legal</td><td> </td><td class="right">   This document is subject to BCP 78 and the IETF Trust's Legal</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Provisions Relating to IETF Documents (https://trustee.ietf.org/</td><td> </td><td class="right">   Provisions Relating to IETF Documents (https://trustee.ietf.org/</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   license-info) in effect on the date of publication of this document.</td><td> </td><td class="right">   license-info) in effect on the date of publication of this document.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Please review these documents carefully, as they describe your rights</td><td> </td><td class="right">   Please review these documents carefully, as they describe your rights</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   and restrictions with respect to this document.  Code Components</td><td> </td><td class="right">   and restrictions with respect to this document.  Code Components</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   extracted from this document must include Revised BSD License text as</td><td> </td><td class="right">   extracted from this document must include Revised BSD License text as</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   described in Section 4.e of the Trust Legal Provisions and are</td><td> </td><td class="right">   described in Section 4.e of the Trust Legal Provisions and are</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   provided without warranty as described in the Revised BSD License.</td><td> </td><td class="right">   provided without warranty as described in the Revised BSD License.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">Table of Contents</td><td> </td><td class="right">Table of Contents</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   1.  Introduction  . . . . . . . . . . . . . . . . . . . . . . . .   3</td><td> </td><td class="right">   1.  Introduction  . . . . . . . . . . . . . . . . . . . . . . . .   3</td><td class="lineno"></td></tr>
      <tr id="diff0004"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">     1.1.  Requirements Language . . . . . . . . . . . . . . . . . .   <span class="delete">3</span></td><td> </td><td class="rblock">     1.1.  Requirements Language . . . . . . . . . . . . . . . . . .   <span class="insert">4</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">     1.2.  Changes from RFC8210  . . . . . . . . . . . . . . . . . .   4</td><td> </td><td class="right">     1.2.  Changes from RFC8210  . . . . . . . . . . . . . . . . . .   4</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   2.  Glossary  . . . . . . . . . . . . . . . . . . . . . . . . . .   4</td><td> </td><td class="right">   2.  Glossary  . . . . . . . . . . . . . . . . . . . . . . . . . .   4</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   3.  Deployment Structure  . . . . . . . . . . . . . . . . . . . .   5</td><td> </td><td class="right">   3.  Deployment Structure  . . . . . . . . . . . . . . . . . . . .   5</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   4.  Operational Overview  . . . . . . . . . . . . . . . . . . . .   6</td><td> </td><td class="right">   4.  Operational Overview  . . . . . . . . . . . . . . . . . . . .   6</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   5.  Protocol Data Units (PDUs)  . . . . . . . . . . . . . . . . .   7</td><td> </td><td class="right">   5.  Protocol Data Units (PDUs)  . . . . . . . . . . . . . . . . .   7</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">     5.1.  Fields of a PDU . . . . . . . . . . . . . . . . . . . . .   7</td><td> </td><td class="right">     5.1.  Fields of a PDU . . . . . . . . . . . . . . . . . . . . .   7</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">     5.2.  Serial Notify . . . . . . . . . . . . . . . . . . . . . .  10</td><td> </td><td class="right">     5.2.  Serial Notify . . . . . . . . . . . . . . . . . . . . . .  10</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">     5.3.  Serial Query  . . . . . . . . . . . . . . . . . . . . . .  11</td><td> </td><td class="right">     5.3.  Serial Query  . . . . . . . . . . . . . . . . . . . . . .  11</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">     5.4.  Reset Query . . . . . . . . . . . . . . . . . . . . . . .  12</td><td> </td><td class="right">     5.4.  Reset Query . . . . . . . . . . . . . . . . . . . . . . .  12</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">     5.5.  Cache Response  . . . . . . . . . . . . . . . . . . . . .  12</td><td> </td><td class="right">     5.5.  Cache Response  . . . . . . . . . . . . . . . . . . . . .  12</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="part-3" class="change" ><td></td><th><small>skipping to change at</small><a href="#part-3"><em> page 2, line 49<span class="hide"> &para;</span></em></a></th><th> </th><th><small>skipping to change at</small><a href="#part-3"><em> page 2, line 49<span class="hide"> &para;</span></em></a></th><td></td></tr>
      <tr><td class="lineno"></td><td class="left">     8.2.  Typical Exchange  . . . . . . . . . . . . . . . . . . . .  25</td><td> </td><td class="right">     8.2.  Typical Exchange  . . . . . . . . . . . . . . . . . . . .  25</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">     8.3.  No Incremental Update Available . . . . . . . . . . . . .  25</td><td> </td><td class="right">     8.3.  No Incremental Update Available . . . . . . . . . . . . .  25</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">     8.4.  Cache Has No Data Available . . . . . . . . . . . . . . .  26</td><td> </td><td class="right">     8.4.  Cache Has No Data Available . . . . . . . . . . . . . . .  26</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   9.  Transport . . . . . . . . . . . . . . . . . . . . . . . . . .  27</td><td> </td><td class="right">   9.  Transport . . . . . . . . . . . . . . . . . . . . . . . . . .  27</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">     9.1.  SSH Transport . . . . . . . . . . . . . . . . . . . . . .  28</td><td> </td><td class="right">     9.1.  SSH Transport . . . . . . . . . . . . . . . . . . . . . .  28</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">     9.2.  TLS Transport . . . . . . . . . . . . . . . . . . . . . .  29</td><td> </td><td class="right">     9.2.  TLS Transport . . . . . . . . . . . . . . . . . . . . . .  29</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">     9.3.  TCP MD5 Transport . . . . . . . . . . . . . . . . . . . .  30</td><td> </td><td class="right">     9.3.  TCP MD5 Transport . . . . . . . . . . . . . . . . . . . .  30</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">     9.4.  TCP-AO Transport  . . . . . . . . . . . . . . . . . . . .  30</td><td> </td><td class="right">     9.4.  TCP-AO Transport  . . . . . . . . . . . . . . . . . . . .  30</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   10. Router-Cache Setup  . . . . . . . . . . . . . . . . . . . . .  30</td><td> </td><td class="right">   10. Router-Cache Setup  . . . . . . . . . . . . . . . . . . . . .  30</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   11. Races, Ordering, and Transactions . . . . . . . . . . . . . .  32</td><td> </td><td class="right">   11. Races, Ordering, and Transactions . . . . . . . . . . . . . .  32</td><td class="lineno"></td></tr>
      <tr id="diff0005"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">     11.1.  <span class="delete">ROA PDU Race Minimization</span>  . . . . . . . . . . . . . . .  32</td><td> </td><td class="rblock">     11.1.  <span class="insert">Races</span>  . . . . . . . . . . . . . . . <span class="insert">. . . . . . . . . .  32</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">     11.2.  <span class="delete">PDU</span> Ordering . . . . . . . . . . . . . . . . . . . . . .  33</td><td> </td><td class="rblock"><span class="insert">       11.1.1.  IPv4/IPv6 PDUs with Different Origins  . . . . . . .  32</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">     <span class="delete">11.3.  Transaction-like Commit</span>  . . . . . . . . . . . . . . . .  33</td><td> </td><td class="rblock"><span class="insert">       11.1.2.  IPv4/IPv6 PDUs for More-Specific Prefixes  . . . . .</span>  32</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   12. Error Codes . . . . . . . . . . . . . . . . . . . . . . . . .  <span class="delete">33</span></td><td> </td><td class="rblock">       <span class="insert">11.1.3.  Withdrawal Before Announcement . . . . . . . . . . .  33</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   13. Security Considerations . . . . . . . . . . . . . . . . . . .  <span class="delete">35</span></td><td> </td><td class="rblock">                                                                         </td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   14. IANA Considerations . . . . . . . . . . . . . . . . . . . . .  <span class="delete">36</span></td><td> </td><td class="rblock">     11.2.  Ordering . . . . . . . . . . . . . . . . . . . . . . <span class="insert">. .</span>  33</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   15. References  . . . . . . . . . . . . . . . . . . . . . . . . .  <span class="delete">37</span></td><td> </td><td class="rblock">       <span class="insert">11.2.1.  IP PDUs  . . . . . .</span> . . . . . . . . . . . . . . . .  33</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">     15.1.</span>  Normative References . . . . . . . . . . . . . . . . . .  <span class="delete">37</span></td><td> </td><td class="rblock">       <span class="insert">11.2.2.  Router Key PDUs  . . . . . . . . . . . . . . . . . .  35</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">     15.2.</span>  Informative References . . . . . . . . . . . . . . . . .  <span class="delete">39</span></td><td> </td><td class="rblock"><span class="insert">       11.2.3.  ASPA PDUs  . . . . . . . . . . . . . . . . . . . . .  35</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   Acknowledgements  . . . . . . . . . . . . . . . . . . . . . . . .  <span class="delete">40</span></td><td> </td><td class="rblock"><span class="insert">     11.3.  Transactions . . . . . . . . . . . . . . . . . . . . . .  36</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   Authors' Addresses  . . . . . . . . . . . . . . . . . . . . . . .  <span class="delete">40</span></td><td> </td><td class="rblock"><span class="insert">     11.4.  Other Considerations . . . . . . . . . . . . . . . . . .  37</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   12. Error Codes . . . . . . . . . . . . . . . . . . . . . . . . .  <span class="insert">38</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   13. Security Considerations . . . . . . . . . . . . . . . . . . .  <span class="insert">39</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   14. IANA Considerations . . . . . . . . . . . . . . . . . . . . .  <span class="insert">40</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   15. <span class="insert">Implementation status . . . . . . . . . . . . . . . . . . . .  41</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">     15.1.  rpki-rtr-demo  . . . . . . . . . . . . . . . . . . . . .  42</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   16.</span> References  . . . . . . . . . . . . . . . . . . . . . . . . .  <span class="insert">42</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">     16.1.</span>  Normative References . . . . . . . . . . . . . . . . . .  <span class="insert">42</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">     16.2.</span>  Informative References . . . . . . . . . . . . . . . . .  <span class="insert">45</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   Acknowledgements  . . . . . . . . . . . . . . . . . . . . . . . .  <span class="insert">46</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   Authors' Addresses  . . . . . . . . . . . . . . . . . . . . . . .  <span class="insert">46</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">1.  Introduction</td><td> </td><td class="right">1.  Introduction</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   In order to verifiably validate the origin Autonomous Systems (ASes)</td><td> </td><td class="right">   In order to verifiably validate the origin Autonomous Systems (ASes)</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   and AS paths of BGP announcements, routers need a simple but reliable</td><td> </td><td class="right">   and AS paths of BGP announcements, routers need a simple but reliable</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   mechanism to receive cryptographically validated Resource Public Key</td><td> </td><td class="right">   mechanism to receive cryptographically validated Resource Public Key</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Infrastructure (RPKI) [RFC6480] prefix origin data, Router Keys, and</td><td> </td><td class="right">   Infrastructure (RPKI) [RFC6480] prefix origin data, Router Keys, and</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   ASPA data from a trusted cache.  This document describes a protocol</td><td> </td><td class="right">   ASPA data from a trusted cache.  This document describes a protocol</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   to deliver them.  The design is intentionally constrained to be</td><td> </td><td class="right">   to deliver them.  The design is intentionally constrained to be</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   usable on much of the current generation of ISP router platforms.</td><td> </td><td class="right">   usable on much of the current generation of ISP router platforms.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="part-4" class="change" ><td></td><th><small>skipping to change at</small><a href="#part-4"><em> page 12, line 24<span class="hide"> &para;</span></em></a></th><th> </th><th><small>skipping to change at</small><a href="#part-4"><em> page 12, line 29<span class="hide"> &para;</span></em></a></th><td></td></tr>
      <tr><td class="lineno"></td><td class="left">   and it should therefore be the cache's job to simplify the change</td><td> </td><td class="right">   and it should therefore be the cache's job to simplify the change</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   set, thus reducing work for the router.</td><td> </td><td class="right">   set, thus reducing work for the router.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   If the cache does not have the data needed to update the router,</td><td> </td><td class="right">   If the cache does not have the data needed to update the router,</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   perhaps because its records do not go back to the Serial Number in</td><td> </td><td class="right">   perhaps because its records do not go back to the Serial Number in</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   the Serial Query, then it responds with a Cache Reset PDU</td><td> </td><td class="right">   the Serial Query, then it responds with a Cache Reset PDU</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   (Section 5.9).</td><td> </td><td class="right">   (Section 5.9).</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   The Session ID tells the cache what instance the router expects to</td><td> </td><td class="right">   The Session ID tells the cache what instance the router expects to</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   ensure that the Serial Numbers are commensurate, i.e., the cache</td><td> </td><td class="right">   ensure that the Serial Numbers are commensurate, i.e., the cache</td><td class="lineno"></td></tr>
      <tr id="diff0006"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   session has not been changed.</td><td> </td><td class="rblock">   session has not been changed.  <span class="insert">If the Session ID does not match, the</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   cache MUST respond with a Cache Reset.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">5.4.  Reset Query</td><td> </td><td class="right">5.4.  Reset Query</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   0          8          16         24        31</td><td> </td><td class="right">   0          8          16         24        31</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   .-------------------------------------------.</td><td> </td><td class="right">   .-------------------------------------------.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   | Protocol |   PDU    |                     |</td><td> </td><td class="right">   | Protocol |   PDU    |                     |</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   | Version  |   Type   |         zero        |</td><td> </td><td class="right">   | Version  |   Type   |         zero        |</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   |    2     |    2     |                     |</td><td> </td><td class="right">   |    2     |    2     |                     |</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   +-------------------------------------------+</td><td> </td><td class="right">   +-------------------------------------------+</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   |                                           |</td><td> </td><td class="right">   |                                           |</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="part-5" class="change" ><td></td><th><small>skipping to change at</small><a href="#part-5"><em> page 32, line 13<span class="hide"> &para;</span></em></a></th><th> </th><th><small>skipping to change at</small><a href="#part-5"><em> page 32, line 13<span class="hide"> &para;</span></em></a></th><td></td></tr>
      <tr><td class="lineno"></td><td class="left">   connection loss if the client has connections to more than one cache.</td><td> </td><td class="right">   connection loss if the client has connections to more than one cache.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   To keep load on Global RPKI services from unnecessary peaks, it is</td><td> </td><td class="right">   To keep load on Global RPKI services from unnecessary peaks, it is</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   recommended that caches which fetch from the Global RPKI not do so</td><td> </td><td class="right">   recommended that caches which fetch from the Global RPKI not do so</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   all at the same times, e.g., on the hour.  Choose a random time,</td><td> </td><td class="right">   all at the same times, e.g., on the hour.  Choose a random time,</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   perhaps the ISP's AS number modulo 60, and jitter the inter-fetch</td><td> </td><td class="right">   perhaps the ISP's AS number modulo 60, and jitter the inter-fetch</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   timing.</td><td> </td><td class="right">   timing.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">11.  Races, Ordering, and Transactions</td><td> </td><td class="right">11.  Races, Ordering, and Transactions</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0007"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   Section 11.1 <span class="delete">describes</span> race conditions <span class="delete">which could, if not mitigated,</span></td><td> </td><td class="rblock">   <span class="insert">If a client applies individual PDUs as they are received from the</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   cause BGP states</span> to <span class="delete">be temporarily marked as Invalid by Route Origin</span></td><td> </td><td class="rblock"><span class="insert">   cache, such that the PDUs are taken into account immediately for the</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   Validation.  Minimal mitigations are described.</span></td><td> </td><td class="rblock"><span class="insert">   purposes of BGP announcement validation, it is possible for a BGP</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   announcement to be classified as invalid incorrectly.  This is</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   because subsequent PDUs received as part of the same cache response</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   would lead to the BGP announcement being classified in some other</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   way.  See</span> Section 11.1 <span class="insert">for examples of when this might occur,</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   Section 11.2 for a mandatory PDU ordering algorithm that acts to</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   mitigate the effect of these</span> race conditions <span class="insert">on clients, and</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   Section 11.3 for client implementation approaches</span> to <span class="insert">these problems.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0008"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">Section 11.2 describes a RECOMMENDED ordering of all PDUs which</span></td><td> </td><td class="rblock">11.1.  <span class="insert">Races</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   allows mitigation of the race conditions described in Section</span> 11.1.</td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0009"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">Section 11.3 describes how a router MAY process ordered PDUs,</span></td><td> </td><td class="rblock"><span class="insert">11.1.1.  IPv4/IPv6 PDUs with Different Origins</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   especially IPvX VRPs, into atomic transactions to be committed in a</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   manner to mitigate the race conditions.</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0010"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">11.1.  ROA</span> PDU <span class="delete">Race Minimization</span></td><td> </td><td class="rblock">   <span class="insert">If two BGP announcements exist for a given IP prefix destination,</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   each with a different origin ASN, then two IP PDUs must be issued by</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   a cache for those BGP announcements to be considered valid under</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   route origin validation (ROV) [RFC6483].  If a client has only one of</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   those PDUs, then the BGP announcement that is validated by the other</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   PDU <span class="insert">will be considered invalid until that other PDU is received.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0011"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">When a cache is sending ROA (IPv4 or IPv6) VRPs to a router,</span></td><td> </td><td class="rblock"><span class="insert">11.1.2.  IPv4/IPv6 PDUs for More-Specific Prefixes</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   undesirable race conditions are possible:</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0012"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">Make Before Break:</span>  For <span class="delete">prefix P, an operator</span> may <span class="delete">create two or more</span></td><td> </td><td class="rblock">   For <span class="insert">a given BGP announcement, there</span> may <span class="insert">be multiple IP PDUs that</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">      ROAs with different ASes because they are in</span> the <span class="delete">process</span> of</td><td> </td><td class="rblock"><span class="insert">   intersect</span> the <span class="insert">BGP announcement's prefix.  If the client does not have</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">      <span class="delete">changing what provider AS</span> may <span class="delete">announce P.  This is a known</span> as</td><td> </td><td class="rblock"><span class="insert">   all</span> of <span class="insert">these PDUs, it</span> may <span class="insert">classify the BGP announcement</span> as <span class="insert">invalid</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">      <span class="delete">"make before break."  If a cache</span> is <span class="delete">feeding</span> a <span class="delete">router</span> and <span class="delete">sends the</span></td><td> </td><td class="rblock"><span class="insert">   under ROV.  For example, if there</span> is a <span class="insert">BGP announcement for</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">      one not yet in service a significant time before sending the one</span></td><td> </td><td class="rblock"><span class="insert">   192.0.2.0/25 with an origin of AS64494, an IPv4 PDU for</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">      currently in service,</span> then <span class="delete">BGP data could be marked Invalid during</span></td><td> </td><td class="rblock"><span class="insert">   192.0.2.0/24-24 with an origin of AS64495,</span> and <span class="insert">an IPv4 PDU for</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">      the interval.  To minimize</span> that <span class="delete">interval,</span> the <span class="delete">cache SHOULD send</span></td><td> </td><td class="rblock"><span class="insert">   192.0.2.0/25-25 with an origin of AS64494,</span> then <span class="insert">a client</span> that <span class="insert">has</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">      all VRPs for</span> the <span class="delete">same prefix as close to sequentially</span> as <span class="delete">possible.</span></td><td> </td><td class="rblock"><span class="insert">   only</span> the <span class="insert">first PDU will classify</span> the <span class="insert">BGP announcement</span> as <span class="insert">invalid.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0013"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">Longest Prefix Match:  If an operator has created a ROA for prefix</span></td><td> </td><td class="rblock"><span class="insert">11.1.3.  Withdrawal Before Announcement</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">      P0, and another operator (often their customer) has created a ROA</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">      for P1 which is a sub-prefix covered by P0, a router which</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">      receives the VRP for P0 before the VRP for P1 might mark BGP for</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">      prefix P1 Invalid until the P1 announcement is processed.</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">      Therefore, the cache SHOULD announce the sub-prefix P1 before the</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">      covering prefix P0.  Conversely, the cache SHOULD withdraw</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">      covering prefixes before covered sub-prefixes.</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0014"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">AS 0:  To minimize risk of inadvertent marking</span> of BGP <span class="delete">data as</span></td><td> </td><td class="rblock">   <span class="insert">If one</span> of <span class="insert">the underlying RPKI objects is modified in such a way that</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">      Invalid, an</span> announcement <span class="delete">VRP</span> for <span class="delete">prefix P which has an AS of 0,</span></td><td> </td><td class="rblock"><span class="insert">   both a PDU withdrawal and a PDU announcement will occur, this can</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">      SHOULD be sent after all other VRPs</span> for <span class="delete">prefix P.  Conversely,</span> a</td><td> </td><td class="rblock"><span class="insert">   lead to a</span> BGP announcement <span class="insert">being considered invalid, if the PDU</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">      withdrawal <span class="delete">VRP for prefix P which has an AS of 0, SHOULD be sent</span></td><td> </td><td class="rblock"><span class="insert">   withdrawal is received first.  For example, if there is a BGP</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">      before all other prefix PDUs for prefix P.</span></td><td> </td><td class="rblock"><span class="insert">   announcement for 192.0.2.0/25 with an origin of AS64494, an IPv4 PDU</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   for <span class="insert">192.0.2.0/24-24 with an origin of AS64495, and an IPv4 PDU</span> for</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   <span class="insert">192.0.2.0/25-25 with an origin of AS64494, then</span> a withdrawal <span class="insert">of the</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   second PDU followed by an announcement of a replacement PDU with a</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   greater max-length will lead to the BGP announcement being classified</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   as invalid under ROV in the time between PDU withdrawal and PDU</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   announcement.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0015"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">11.2.  <span class="delete">PDU </span>Ordering</td><td> </td><td class="rblock">11.2.  Ordering</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0016"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">A Version</span> 2 <span class="delete">Cache SHOULD, unless it requires major revision of</span></td><td> </td><td class="rblock">   <span class="insert">For a protocol version</span> 2 <span class="insert">session, caches MUST use the ordering</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   existing code, order Payload</span> PDUs <span class="delete">it sends</span> to <span class="delete">routers.  Ascending</span></td><td> </td><td class="rblock"><span class="insert">   defined in this section when sending</span> PDUs to <span class="insert">clients</span> as <span class="insert">part of a</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   order is considered somewhat more efficient</span> as <span class="delete">routers are likely</span></td><td> </td><td class="rblock"><span class="insert">   cache response.  Caches SHOULD use</span> the ordering <span class="insert">defined in this</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   building trees.  Iff ordering, with</span> the <span class="delete">exceptions in Section 11.1</span></td><td> </td><td class="rblock"><span class="insert">   section for sessions using earlier protocol versions</span> as <span class="insert">well, though</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   above,</span> ordering <span class="delete">MUST be,</span> as <span class="delete">follows:</span></td><td> </td><td class="rblock"><span class="insert">   a cache may prefer to preserve its existing behaviour for the sake of</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   backwards compatibility.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0017"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">1  PDUs are first ordered by PDU Type,</span></td><td> </td><td class="rblock">   <span class="insert">The ordering definitions in this section have been modelled on those</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   from Section 4.3.3 of [RFC9582].</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0018"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">2  IPv4 and IPv6 Prefix VRPs are ordered by: first IPvX Prefix,</span></td><td> </td><td class="rblock">   <span class="insert">The ordering defined in this section is a total ordering.  While a</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">      second Prefix Length (largest value first for announcements,</span></td><td> </td><td class="rblock"><span class="insert">   partial ordering could be defined that had</span> the <span class="insert">same benefits as far</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">      lowest value first for withdrawals), third Max Length, and fourth</span></td><td> </td><td class="rblock">   as <span class="insert">race conditions are concerned, a total ordering makes it easier</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">      Autonomous System Number.  Treating announcements of VPUs with AS</span></td><td> </td><td class="rblock"><span class="insert">   for clients to verify that</span> the <span class="insert">ordering is correct, and may also</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">      0 as sorting last, and withdrawals as sorting first, fulfills</span> the</td><td> </td><td class="rblock"><span class="insert">   provide opportunities for client optimisations.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">      <span class="delete">"AS 0" requirement of Section 11.1.  Treating announcements of</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">      sub-prefixes</span> as <span class="delete">sorting first fulfills</span> the <span class="delete">"Longest Prefix Match"</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">      requirement of Section 11.1.</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0019"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">3  Router Key</span> PDUs <span class="delete">are ordered by AS Number and then Subject Public</span></td><td> </td><td class="rblock">   PDUs <span class="insert">with a lower integer PDU type precede PDUs with a higher integer</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">      Key Info.</span></td><td> </td><td class="rblock"><span class="insert">   PDU type.  The sections that follow describe ordering as among PDUs</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   of the same type.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0020"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   4  And ASPA PDUs ordered by Customer AS.</span></td><td> </td><td class="rblock"><span class="insert">11.2.1.  IP PDUs</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0021"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">Unless specifically configured for a particular cache, a router MUST</span></td><td> </td><td class="rblock">   <span class="insert">In order to semantically compare and sort IP PDUs, each</span> PDU <span class="insert">is mapped</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   NOT depend on payload</span> PDU <span class="delete">ordering.</span></td><td> </td><td class="rblock"><span class="insert">   to an abstract data element comprising five integer values:</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0022"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">11.3.  Transaction-like Commit</span></td><td> </td><td class="rblock">   <span class="insert">addr  The first IP address of the IP prefix appearing in the PDU, as</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      a 32-bit (IPv4) or 128-bit (IPv6) integer value.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0023"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">Iff a router has been configured to know that a particular cache's</span></td><td> </td><td class="rblock">   <span class="insert">plen  The length</span> of <span class="insert">the IP</span> prefix <span class="insert">appearing in the PDU, as an integer</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   data are ordered per Section 11.2, a router MAY wait to commit, i.e.</span></td><td> </td><td class="rblock"><span class="insert">      value.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   make effective, IPvX VRPs only after all sub-prefixes</span> of <span class="delete">a received</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   covering</span> prefix <span class="delete">are received.</span></td><td> </td><td class="rblock"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0024"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">Another method</span> a <span class="delete">router MAY choose to mitigate</span> the <span class="delete">above race</span></td><td> </td><td class="rblock">   <span class="insert">mlen  The max length appearing in the PDU, as an integer value.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"><span class="delete">   conditions</span> is <span class="delete">not</span> to <span class="delete">commit, i.e. make effective,</span> the <span class="delete">VRPs received</span></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   in <span class="delete">response</span> to a <span class="delete">request until</span> the <span class="delete">relevant End</span> of Data PDU is</td><td> </td><td class="rblock"><span class="insert">   asn  The origin ASN appearing in the PDU, as an integer value.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">received.  During start</span> or <span class="delete">restart</span> of a <span class="delete">session, this</span> approach may</td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   <span class="delete">consume considerable memory.  If using this approach,</span> a <span class="delete">router MUST</span></td><td> </td><td class="rblock"><span class="insert">   updt  The integer 1, if the PDU is an announcement, and the integer</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   apply a time <span class="delete">limit</span> for how <span class="delete">long</span> it is <span class="delete">willing</span> to <span class="delete">wait for</span> the End of</td><td> </td><td class="rblock"><span class="insert">      0, if the PDU is</span> a <span class="insert">withdrawal.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   Data PDU.</td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   The equality or relative order of two IP PDUs can be tested by</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   comparing their abstract representations.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   The first order comparison is based on</span> the <span class="insert">updt value.  Data elements</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   with an updt value of 1 precede data elements with an updt value of</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   0.  This addresses the problem described in Section 11.1.3.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   The order of two IP PDUs with updt values of 1</span> is <span class="insert">determined by the</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   first non-equal comparison in the following list.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   1.  Data elements with a higher addr value precede data elements with</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       a lower addr value.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   2.  Data elements with a higher mlen value precede data elements with</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       a lower mlen value.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   3.  Data elements with a higher plen value precede data elements with</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       a lower plen value.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   4.  Data elements with a higher asn value precede data elements with</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       a lower asn value.  This ensures that AS0 PDU announcements,</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       which can be used</span> to <span class="insert">cause BGP announcements to become invalid</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       under ROV, always appear after all other relevant PDU</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       announcements.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   The order of two IP PDUs with updt values of 0 is determined by</span> the</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   <span class="insert">first non-equal comparison</span> in <span class="insert">the following list.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   1.  Data elements with a lower addr value precede data elements with</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       a higher addr value.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   2.  Data elements with a lower mlen value precede data elements with</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       a higher mlen value.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   3.  Data elements with a lower plen value precede data elements with</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       a higher plen value.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   4.  Data elements with a lower asn value precede data elements with a</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       higher asn value.  This ensures that AS0 PDU withdrawals always</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       appear before all other relevant PDU withdrawals.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   For both announcement and withdrawal PDUs, the first three</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   comparisons are included so as to address the problem described in</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   Section 11.1.2.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">11.2.2.  Router Key PDUs</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   In order</span> to <span class="insert">semantically compare and sort Router Key PDUs, each PDU</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   is mapped to an abstract data element comprising five values:</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   ski  The Subject Key Identifier appearing in the PDU, as binary data</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      (20 octets in length).</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   spkinfo  The Subject Public Key Info appearing in the PDU, as DER-</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      encoded data.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   spkinfolen  The number of octets in spkinfo.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   asn  The ASN appearing in the PDU, as an integer value.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   updt  The integer 1, if the PDU is an announcement, and the integer</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      0, if the PDU is</span> a <span class="insert">withdrawal.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   The equality or relative order of two Router Key PDUs can be tested</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   by comparing their abstract representations.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   1.  Data elements with an updt value of 1 precede data elements with</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       an updt value of 0.  This addresses</span> the <span class="insert">problem described in</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       Section 11.1.3.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   2.  Data elements are then ordered based on their ski values.  This</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       ordering is lexicographical: each octet</span> of <span class="insert">binary data is treated</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       as a symbol to compare, with the symbols ordered by their</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       numerical value.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   3.</span>  Data <span class="insert">elements with a lower spkinfolen value precede data elements</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       with a higher spkinfolen value.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   4.  Data elements are then ordered based on their spkinfo values.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       This ordering is the same as for the ski values.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   5.  Data elements with a lower asn value precede data elements with a</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       higher asn value.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">11.2.3.  ASPA PDUs</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   In order to semantically compare and sort ASPA PDUs, each PDU is</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   mapped to an abstract data element comprising two integer values:</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   casn  The customer ASN appearing in the PDU, as an integer value.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   updt  The integer 1, if the</span> PDU is <span class="insert">an announcement, and the integer</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      0, if the PDU is a withdrawal.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   The equality</span> or <span class="insert">relative order</span> of <span class="insert">two ASPA PDUs can be tested by</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   comparing their abstract representations.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   1.  Data elements with an updt value of 1 precede data elements with</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       an updt value of 0.  This addresses the problem described in</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       Section 11.1.3.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   2.  Data elements with</span> a <span class="insert">lower casn value precede data elements with</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">       a higher casn value.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">11.3.  Transactions</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   Clients are RECOMMENDED to apply PDUs only on receipt of an End of</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   Data PDU.  This implementation</span> approach <span class="insert">will ensure that the client</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   is unaffected by the problems described in Section 11.1.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   A client</span> may <span class="insert">be unable to apply PDUs only on receipt of an End of</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   Data PDU, due e.g. to memory limitations.  An alternative</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   implementation approach that a client can use is to apply IP PDUs as</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   a <span class="insert">single group if their prefixes are equal.  Since the mandatory</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   ordering is such that those PDUs will appear in sequence, and such</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   groups will generally be small, this should be easier for clients to</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   support.  A client that implements this approach is safe with respect</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   to all of the problems described in Section 11.1.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   A client that is unable to</span> apply <span class="insert">PDUs only on receipt of an End of</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   Data PDU, and also unable to implement the alternative implementation</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   approach described in this section, will be at risk of encountering</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   the problems described in Section 11.1.  While such problems will</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   generally be transient, because</span> a <span class="insert">subsequent PDU received during the</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   same synchronisation attempt should act to rectify the problem, there</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   is a risk that those PDUs are not received due to an error during the</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   synchronisation attempt.  In that scenario, clients SHOULD revert the</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   application of any PDUs received during the failed synchronisation</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   attempt.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">11.4.  Other Considerations</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   A client that applies PDUs transactionally (e.g. on receipt of an End</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   of Data PDU) SHOULD consider limiting the period of</span> time for <span class="insert">which it</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   will wait for the PDU that will close the transaction.  This is</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   especially important when initiating or resetting a session, since it</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   may take some time to receive all relevant data from the cache.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   [todo: There were comments about adding guidance as to the timeout</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   here, but</span> how <span class="insert">should that be determined?  Can</span> it <span class="insert">be based on the</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   expiry interval, or something like that?]</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   A client MAY verify the ordering of PDUs, and when an ordering error</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   is <span class="insert">encountered, send an Ordering Error PDU</span> to the <span class="insert">server and</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   terminate the session.  However, given that ordering issues lead only</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   to transient problems, and also that resetting the session with the</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   same cache is unlikely to fix the problem, clients should consider</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   whether terminating the session is worthwhile.  For example, if</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   another cache is available, that may weigh in favour of terminating</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   the current session and switching to that other cache.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   Section 11.1 describes various scenarios where immediate application</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   of PDUs can cause problems, depending on the order in which they are</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   returned.  A related problem is where an RPKI CA operator makes non-</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   atomic changes to RPKI objects in such a way that the same ordering</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   problem occurs, due to the cache receiving the updates at different</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   times.  However, RPKI CAs are able to make groups of changes take</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   effect atomically, so in the common case where this problem arises,</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   it will be due to limitations in CA implementations.  Even in a case</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   where a group of changes cannot be made to take effect atomically, it</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   will be possible to order the changes at the CA such that no problems</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   occur.  For example, the operator could add a new ROA prior to</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   removing an old ROA, allowing enough time between the operations that</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   the risk of a cache or a client receiving both updates at the same</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   time is low.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   Related to the previous paragraph is the scenario where RPKI objects</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   that need to be ordered in a specific way are issued by separate CAs.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   As with non-atomic operations by a single CA, CA operators in this</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   situation must co-ordinate so as to ensure that the operations are</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   ordered correctly and that there is sufficient time between the</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   operations.  CA operators in this situation should consider managing</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   all such RPKI objects within a single CA, though, to avoid the</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   problems that arise here.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   A client that is generally unable to apply PDUs only on receipt of an</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   End of Data <span class="insert">PDU should consider whether it is possible to implement</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   that behaviour at least in the context of new session initiation and</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   session reset.  Doing so will limit the risk of BGP announcements</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   being used for a short period of time before being rejected due to</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   the receipt of an invalidating</span> PDU.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">12.  Error Codes</td><td> </td><td class="right">12.  Error Codes</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   This section describes the meaning of the error codes.  There is an</td><td> </td><td class="right">   This section describes the meaning of the error codes.  There is an</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   IANA registry where valid error codes are listed; see [iana-err].</td><td> </td><td class="right">   IANA registry where valid error codes are listed; see [iana-err].</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Errors which are considered fatal MUST cause the session to be</td><td> </td><td class="right">   Errors which are considered fatal MUST cause the session to be</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   dropped, and the router MUST flush all data learned from that cache.</td><td> </td><td class="right">   dropped, and the router MUST flush all data learned from that cache.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   0: Corrupt Data (fatal):  The receiver believes the received PDU to</td><td> </td><td class="right">   0: Corrupt Data (fatal):  The receiver believes the received PDU to</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      be corrupt in a manner not specified by another error code.</td><td> </td><td class="right">      be corrupt in a manner not specified by another error code.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="part-6" class="change" ><td></td><th><small>skipping to change at</small><a href="#part-6"><em> page 34, line 51<span class="hide"> &para;</span></em></a></th><th> </th><th><small>skipping to change at</small><a href="#part-6"><em> page 39, line 17<span class="hide"> &para;</span></em></a></th><td></td></tr>
      <tr><td class="lineno"></td><td class="left">      already active in the router.</td><td> </td><td class="right">      already active in the router.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   8: Unexpected Protocol Version (fatal):  The received PDU has a</td><td> </td><td class="right">   8: Unexpected Protocol Version (fatal):  The received PDU has a</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      Protocol Version field that differs from the protocol version</td><td> </td><td class="right">      Protocol Version field that differs from the protocol version</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      negotiated in Section 7.</td><td> </td><td class="right">      negotiated in Section 7.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   9: ASPA Provider List Error (fatal):  The received ASPA PDU has an</td><td> </td><td class="right">   9: ASPA Provider List Error (fatal):  The received ASPA PDU has an</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      incorrect list of Provider Autonomous System Numbers.</td><td> </td><td class="right">      incorrect list of Provider Autonomous System Numbers.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   10: Transport Error (fatal):  An error such as a stall (see</td><td> </td><td class="right">   10: Transport Error (fatal):  An error such as a stall (see</td><td class="lineno"></td></tr>
      <tr id="diff0025"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">      Section 9) or <span class="delete">tother</span> transport layer failure occurred.</td><td> </td><td class="rblock">      Section 9) or <span class="insert">other</span> transport layer failure occurred.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">                                                                         </td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   <span class="insert">11: Ordering Error (fatal):  The received PDU does not conform with</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      the ordering defined in Section 11.2.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">13.  Security Considerations</td><td> </td><td class="right">13.  Security Considerations</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   As this document describes a security protocol, many aspects of</td><td> </td><td class="right">   As this document describes a security protocol, many aspects of</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   security interest are described in the relevant sections.  This</td><td> </td><td class="right">   security interest are described in the relevant sections.  This</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   section points out issues which may not be obvious in other sections.</td><td> </td><td class="right">   section points out issues which may not be obvious in other sections.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Cache Peer Identification:  The router initiates a transport</td><td> </td><td class="right">   Cache Peer Identification:  The router initiates a transport</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      connection to a cache, which it identifies by either IP address or</td><td> </td><td class="right">      connection to a cache, which it identifies by either IP address or</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">      fully qualified domain name.  Be aware that a DNS or address</td><td> </td><td class="right">      fully qualified domain name.  Be aware that a DNS or address</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="part-7" class="change" ><td></td><th><small>skipping to change at</small><a href="#part-7"><em> page 36, line 46<span class="hide"> &para;</span></em></a></th><th> </th><th><small>skipping to change at</small><a href="#part-7"><em> page 41, line 19<span class="hide"> &para;</span></em></a></th><td></td></tr>
      <tr><td class="lineno"></td><td class="left">                 1   Internal Error</td><td> </td><td class="right">                 1   Internal Error</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">                 2   No Data Available</td><td> </td><td class="right">                 2   No Data Available</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">                 3   Invalid Request</td><td> </td><td class="right">                 3   Invalid Request</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">                 4   Unsupported Protocol Version</td><td> </td><td class="right">                 4   Unsupported Protocol Version</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">                 5   Unsupported PDU Type</td><td> </td><td class="right">                 5   Unsupported PDU Type</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">                 6   Withdrawal of Unknown Record</td><td> </td><td class="right">                 6   Withdrawal of Unknown Record</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">                 7   Duplicate Announcement Received</td><td> </td><td class="right">                 7   Duplicate Announcement Received</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">                 8   Unexpected Protocol Version</td><td> </td><td class="right">                 8   Unexpected Protocol Version</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">                 9   ASPA Provider List Error</td><td> </td><td class="right">                 9   ASPA Provider List Error</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">                10   Transport Failure</td><td> </td><td class="right">                10   Transport Failure</td><td class="lineno"></td></tr>
      <tr id="diff0026"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">                11   Ordering Error</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">            11-254   Unassigned</td><td> </td><td class="right">            11-254   Unassigned</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">               255   Reserved</td><td> </td><td class="right">               255   Reserved</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   The "rpki-rtr-pdu" registry [iana-pdu] has been updated as follows:</td><td> </td><td class="right">   The "rpki-rtr-pdu" registry [iana-pdu] has been updated as follows:</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">              Protocol   PDU</td><td> </td><td class="right">              Protocol   PDU</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">              Version    Type  Description</td><td> </td><td class="right">              Version    Type  Description</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">              --------   ----  ---------------</td><td> </td><td class="right">              --------   ----  ---------------</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">                 0-2       0   Serial Notify</td><td> </td><td class="right">                 0-2       0   Serial Notify</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">                 0-2       1   Serial Query</td><td> </td><td class="right">                 0-2       1   Serial Query</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="part-8" class="change" ><td></td><th><small>skipping to change at</small><a href="#part-8"><em> page 37, line 23<span class="hide"> &para;</span></em></a></th><th> </th><th><small>skipping to change at</small><a href="#part-8"><em> page 41, line 43<span class="hide"> &para;</span></em></a></th><td></td></tr>
      <tr><td class="lineno"></td><td class="left">                 0-2       6   IPv6 Prefix</td><td> </td><td class="right">                 0-2       6   IPv6 Prefix</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">                 0-2       7   End of Data</td><td> </td><td class="right">                 0-2       7   End of Data</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">                 0-2       8   Cache Reset</td><td> </td><td class="right">                 0-2       8   Cache Reset</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">                  0        9   Reserved</td><td> </td><td class="right">                  0        9   Reserved</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">                 1-2       9   Router Key</td><td> </td><td class="right">                 1-2       9   Router Key</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">                 0-2      10   Error Report</td><td> </td><td class="right">                 0-2      10   Error Report</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">                 0-1      11   Reserved</td><td> </td><td class="right">                 0-1      11   Reserved</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">                  2       11   ASPA</td><td> </td><td class="right">                  2       11   ASPA</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">                 0-2     255   Reserved</td><td> </td><td class="right">                 0-2     255   Reserved</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0027"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">15.  <span class="delete">Reference</span>s</td><td> </td><td class="rblock">15.  <span class="insert">Implementation statu</span>s</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0028"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">15.1.  Normative References</td><td> </td><td class="rblock">   <span class="insert">This section is to be removed before publishing as an RFC.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   This section records the status of known implementations of the</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   protocol defined by this specification at the time of posting of this</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   Internet-Draft, and is based on a proposal described in [RFC7942].</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   The description of implementations in this section is intended to</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   assist the IETF in its decision processes in progressing drafts to</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   RFCs.  Please note that the listing of any individual implementation</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   here does not imply endorsement by the IETF.  Furthermore, no effort</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   has been spent to verify the information presented here that was</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   supplied by IETF contributors.  This is not intended as, and must not</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   be construed to be, a catalog of available implementations or their</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   features.  Readers are advised to note that other implementations may</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   exist.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   According to [RFC7942], "this will allow reviewers and working groups</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   to assign due consideration to documents that have the benefit of</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   running code, which may serve as evidence of valuable experimentation</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   and feedback that have made the implemented protocols more mature.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   It is up to the individual working groups to use this information as</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   they see fit".</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">                                                                         </td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">15.1.  <span class="insert">rpki-rtr-demo</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *  Responsible Organization: APNIC</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *  Location: https://github.com/APNIC-net/rpki-rtr-demo</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *  Description: This implementation supports the behaviour described</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      in this document.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *  Level of Maturity: This is a proof-of-concept implementation.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *  Coverage: This implementation includes all of the features</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">      described in this specification, except for TCP-AO.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">   *  Contact Information: Tom Harrison, tomh@apnic.net</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">16.  References</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert"></span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">16.1.</span>  Normative References</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   [BCP195]   Moriarty, K. and S. Farrell, "Deprecating TLS 1.0 and TLS</td><td> </td><td class="right">   [BCP195]   Moriarty, K. and S. Farrell, "Deprecating TLS 1.0 and TLS</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">              1.1", BCP 195, RFC 8996, March 2021.</td><td> </td><td class="right">              1.1", BCP 195, RFC 8996, March 2021.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">              Sheffer, Y., Saint-Andre, P., and T. Fossati,</td><td> </td><td class="right">              Sheffer, Y., Saint-Andre, P., and T. Fossati,</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">              "Recommendations for Secure Use of Transport Layer</td><td> </td><td class="right">              "Recommendations for Secure Use of Transport Layer</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">              Security (TLS) and Datagram Transport Layer Security</td><td> </td><td class="right">              Security (TLS) and Datagram Transport Layer Security</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">              (DTLS)", BCP 195, RFC 9325, November 2022.</td><td> </td><td class="right">              (DTLS)", BCP 195, RFC 9325, November 2022.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">              &lt;https://www.rfc-editor.org/info/bcp195&gt;</td><td> </td><td class="right">              &lt;https://www.rfc-editor.org/info/bcp195&gt;</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   [I-D.ietf-sidrops-aspa-profile]</td><td> </td><td class="right">   [I-D.ietf-sidrops-aspa-profile]</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">              Azimov, A., Uskov, E., Bush, R., Snijders, J., Housley,</td><td> </td><td class="right">              Azimov, A., Uskov, E., Bush, R., Snijders, J., Housley,</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">              R., and B. Maddison, "A Profile for Autonomous System</td><td> </td><td class="right">              R., and B. Maddison, "A Profile for Autonomous System</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">              Provider Authorization", Work in Progress, Internet-Draft,</td><td> </td><td class="right">              Provider Authorization", Work in Progress, Internet-Draft,</td><td class="lineno"></td></tr>
      <tr id="diff0029"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">              draft-ietf-sidrops-aspa-profile-<span class="delete">19, 6 January</span> 2025,</td><td> </td><td class="rblock">              draft-ietf-sidrops-aspa-profile-<span class="insert">20, 18 August</span> 2025,</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">              &lt;https://datatracker.ietf.org/doc/html/draft-ietf-sidrops-</td><td> </td><td class="right">              &lt;https://datatracker.ietf.org/doc/html/draft-ietf-sidrops-</td><td class="lineno"></td></tr>
      <tr id="diff0030"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">              aspa-profile-<span class="delete">19</span>&gt;.</td><td> </td><td class="rblock">              aspa-profile-<span class="insert">20</span>&gt;.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   [iana-err] IANA, "rpki-rtr-error",</td><td> </td><td class="right">   [iana-err] IANA, "rpki-rtr-error",</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">              &lt;https://www.iana.org/assignments/rpki#rpki-rtr-error&gt;.</td><td> </td><td class="right">              &lt;https://www.iana.org/assignments/rpki#rpki-rtr-error&gt;.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   [iana-pdu] IANA, "rpki-rtr-pdu",</td><td> </td><td class="right">   [iana-pdu] IANA, "rpki-rtr-pdu",</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">              &lt;https://www.iana.org/assignments/rpki#rpki-rtr-pdu&gt;.</td><td> </td><td class="right">              &lt;https://www.iana.org/assignments/rpki#rpki-rtr-pdu&gt;.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   [RFC1982]  Elz, R. and R. Bush, "Serial Number Arithmetic", RFC 1982,</td><td> </td><td class="right">   [RFC1982]  Elz, R. and R. Bush, "Serial Number Arithmetic", RFC 1982,</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">              DOI 10.17487/RFC1982, August 1996,</td><td> </td><td class="right">              DOI 10.17487/RFC1982, August 1996,</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">              &lt;https://www.rfc-editor.org/info/rfc1982&gt;.</td><td> </td><td class="right">              &lt;https://www.rfc-editor.org/info/rfc1982&gt;.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="part-9" class="change" ><td></td><th><small>skipping to change at</small><a href="#part-9"><em> page 39, line 5<span class="hide"> &para;</span></em></a></th><th> </th><th><small>skipping to change at</small><a href="#part-9"><em> page 44, line 12<span class="hide"> &para;</span></em></a></th><td></td></tr>
      <tr><td class="lineno"></td><td class="left">              DOI 10.17487/RFC5926, June 2010,</td><td> </td><td class="right">              DOI 10.17487/RFC5926, June 2010,</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">              &lt;https://www.rfc-editor.org/info/rfc5926&gt;.</td><td> </td><td class="right">              &lt;https://www.rfc-editor.org/info/rfc5926&gt;.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   [RFC6125]  Saint-Andre, P. and J. Hodges, "Representation and</td><td> </td><td class="right">   [RFC6125]  Saint-Andre, P. and J. Hodges, "Representation and</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">              Verification of Domain-Based Application Service Identity</td><td> </td><td class="right">              Verification of Domain-Based Application Service Identity</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">              within Internet Public Key Infrastructure Using X.509</td><td> </td><td class="right">              within Internet Public Key Infrastructure Using X.509</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">              (PKIX) Certificates in the Context of Transport Layer</td><td> </td><td class="right">              (PKIX) Certificates in the Context of Transport Layer</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">              Security (TLS)", RFC 6125, DOI 10.17487/RFC6125, March</td><td> </td><td class="right">              Security (TLS)", RFC 6125, DOI 10.17487/RFC6125, March</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">              2011, &lt;https://www.rfc-editor.org/info/rfc6125&gt;.</td><td> </td><td class="right">              2011, &lt;https://www.rfc-editor.org/info/rfc6125&gt;.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0031"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   <span class="insert">[RFC6483]  Huston, G. and G. Michaelson, "Validation of Route</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">              Origination Using the Resource Certificate Public Key</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">              Infrastructure (PKI) and Route Origin Authorizations</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">              (ROAs)", RFC 6483, DOI 10.17487/RFC6483, February 2012,</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">              &lt;https://www.rfc-editor.org/info/rfc6483&gt;.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">                                                                         </td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   [RFC6487]  Huston, G., Michaelson, G., and R. Loomans, "A Profile for</td><td> </td><td class="right">   [RFC6487]  Huston, G., Michaelson, G., and R. Loomans, "A Profile for</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">              X.509 PKIX Resource Certificates", RFC 6487,</td><td> </td><td class="right">              X.509 PKIX Resource Certificates", RFC 6487,</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">              DOI 10.17487/RFC6487, February 2012,</td><td> </td><td class="right">              DOI 10.17487/RFC6487, February 2012,</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">              &lt;https://www.rfc-editor.org/info/rfc6487&gt;.</td><td> </td><td class="right">              &lt;https://www.rfc-editor.org/info/rfc6487&gt;.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   [RFC6810]  Bush, R. and R. Austein, "The Resource Public Key</td><td> </td><td class="right">   [RFC6810]  Bush, R. and R. Austein, "The Resource Public Key</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">              Infrastructure (RPKI) to Router Protocol", RFC 6810,</td><td> </td><td class="right">              Infrastructure (RPKI) to Router Protocol", RFC 6810,</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">              DOI 10.17487/RFC6810, January 2013,</td><td> </td><td class="right">              DOI 10.17487/RFC6810, January 2013,</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">              &lt;https://www.rfc-editor.org/info/rfc6810&gt;.</td><td> </td><td class="right">              &lt;https://www.rfc-editor.org/info/rfc6810&gt;.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="part-10" class="change" ><td></td><th><small>skipping to change at</small><a href="#part-10"><em> page 39, line 42<span class="hide"> &para;</span></em></a></th><th> </th><th><small>skipping to change at</small><a href="#part-10"><em> page 45, line 9<span class="hide"> &para;</span></em></a></th><td></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   [RFC8608]  Turner, S. and O. Borchert, "BGPsec Algorithms, Key</td><td> </td><td class="right">   [RFC8608]  Turner, S. and O. Borchert, "BGPsec Algorithms, Key</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">              Formats, and Signature Formats", RFC 8608,</td><td> </td><td class="right">              Formats, and Signature Formats", RFC 8608,</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">              DOI 10.17487/RFC8608, June 2019,</td><td> </td><td class="right">              DOI 10.17487/RFC8608, June 2019,</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">              &lt;https://www.rfc-editor.org/info/rfc8608&gt;.</td><td> </td><td class="right">              &lt;https://www.rfc-editor.org/info/rfc8608&gt;.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   [RFC8635]  Bush, R., Turner, S., and K. Patel, "Router Keying for</td><td> </td><td class="right">   [RFC8635]  Bush, R., Turner, S., and K. Patel, "Router Keying for</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">              BGPsec", RFC 8635, DOI 10.17487/RFC8635, August 2019,</td><td> </td><td class="right">              BGPsec", RFC 8635, DOI 10.17487/RFC8635, August 2019,</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">              &lt;https://www.rfc-editor.org/info/rfc8635&gt;.</td><td> </td><td class="right">              &lt;https://www.rfc-editor.org/info/rfc8635&gt;.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0032"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">1<span class="delete">5</span>.2.  Informative References</td><td> </td><td class="rblock">1<span class="insert">6</span>.2.  Informative References</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   [RFC1996]  Vixie, P., "A Mechanism for Prompt Notification of Zone</td><td> </td><td class="right">   [RFC1996]  Vixie, P., "A Mechanism for Prompt Notification of Zone</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">              Changes (DNS NOTIFY)", RFC 1996, DOI 10.17487/RFC1996,</td><td> </td><td class="right">              Changes (DNS NOTIFY)", RFC 1996, DOI 10.17487/RFC1996,</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">              August 1996, &lt;https://www.rfc-editor.org/info/rfc1996&gt;.</td><td> </td><td class="right">              August 1996, &lt;https://www.rfc-editor.org/info/rfc1996&gt;.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   [RFC4808]  Bellovin, S., "Key Change Strategies for TCP-MD5",</td><td> </td><td class="right">   [RFC4808]  Bellovin, S., "Key Change Strategies for TCP-MD5",</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">              RFC 4808, DOI 10.17487/RFC4808, March 2007,</td><td> </td><td class="right">              RFC 4808, DOI 10.17487/RFC4808, March 2007,</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">              &lt;https://www.rfc-editor.org/info/rfc4808&gt;.</td><td> </td><td class="right">              &lt;https://www.rfc-editor.org/info/rfc4808&gt;.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   [RFC5781]  Weiler, S., Ward, D., and R. Housley, "The rsync URI</td><td> </td><td class="right">   [RFC5781]  Weiler, S., Ward, D., and R. Housley, "The rsync URI</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="part-11" class="change" ><td></td><th><small>skipping to change at</small><a href="#part-11"><em> page 40, line 22<span class="hide"> &para;</span></em></a></th><th> </th><th><small>skipping to change at</small><a href="#part-11"><em> page 45, line 36<span class="hide"> &para;</span></em></a></th><td></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   [RFC6481]  Huston, G., Loomans, R., and G. Michaelson, "A Profile for</td><td> </td><td class="right">   [RFC6481]  Huston, G., Loomans, R., and G. Michaelson, "A Profile for</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">              Resource Certificate Repository Structure", RFC 6481,</td><td> </td><td class="right">              Resource Certificate Repository Structure", RFC 6481,</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">              DOI 10.17487/RFC6481, February 2012,</td><td> </td><td class="right">              DOI 10.17487/RFC6481, February 2012,</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">              &lt;https://www.rfc-editor.org/info/rfc6481&gt;.</td><td> </td><td class="right">              &lt;https://www.rfc-editor.org/info/rfc6481&gt;.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   [RFC793]   Postel, J., "Transmission Control Protocol", RFC 793,</td><td> </td><td class="right">   [RFC793]   Postel, J., "Transmission Control Protocol", RFC 793,</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">              DOI 10.17487/RFC0793, September 1981,</td><td> </td><td class="right">              DOI 10.17487/RFC0793, September 1981,</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">              &lt;https://www.rfc-editor.org/info/rfc793&gt;.</td><td> </td><td class="right">              &lt;https://www.rfc-editor.org/info/rfc793&gt;.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0033"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   <span class="insert">[RFC7942]  Sheffer, Y. and A. Farrel, "Improving Awareness of Running</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">              Code: The Implementation Status Section", BCP 205,</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">              RFC 7942, DOI 10.17487/RFC7942, July 2016,</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">              &lt;https://www.rfc-editor.org/info/rfc7942&gt;.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">                                                                         </td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   [RFC8654]  Bush, R., Patel, K., and D. Ward, "Extended Message</td><td> </td><td class="right">   [RFC8654]  Bush, R., Patel, K., and D. Ward, "Extended Message</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">              Support for BGP", RFC 8654, DOI 10.17487/RFC8654, October</td><td> </td><td class="right">              Support for BGP", RFC 8654, DOI 10.17487/RFC8654, October</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">              2019, &lt;https://www.rfc-editor.org/info/rfc8654&gt;.</td><td> </td><td class="right">              2019, &lt;https://www.rfc-editor.org/info/rfc8654&gt;.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   [RFC9293]  Eddy, W., Ed., "Transmission Control Protocol (TCP)",</td><td> </td><td class="right">   [RFC9293]  Eddy, W., Ed., "Transmission Control Protocol (TCP)",</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">              STD 7, RFC 9293, DOI 10.17487/RFC9293, August 2022,</td><td> </td><td class="right">              STD 7, RFC 9293, DOI 10.17487/RFC9293, August 2022,</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">              &lt;https://www.rfc-editor.org/info/rfc9293&gt;.</td><td> </td><td class="right">              &lt;https://www.rfc-editor.org/info/rfc9293&gt;.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr id="diff0034"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">   <span class="insert">[RFC9582]  Snijders, J., Maddison, B., Lepinski, M., Kong, D., and S.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">              Kent, "A Profile for Route Origin Authorizations (ROAs)",</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">              RFC 9582, DOI 10.17487/RFC9582, May 2024,</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock"><span class="insert">              &lt;https://www.rfc-editor.org/info/rfc9582&gt;.</span></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock"></td><td> </td><td class="rblock">                                                                         </td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">Acknowledgements</td><td> </td><td class="right">Acknowledgements</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   The authors wish to thank Nils Bars, Steve Bellovin, Oliver Borchert,</td><td> </td><td class="right">   The authors wish to thank Nils Bars, Steve Bellovin, Oliver Borchert,</td><td class="lineno"></td></tr>
      <tr id="diff0035"><td></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   Mohamed Boucadair, Tim Bruijnzeels, Roman Danyliw, Rex Fernando,</td><td> </td><td class="rblock">   Mohamed Boucadair, Tim Bruijnzeels, <span class="insert">Ralph Covelli,</span> Roman Danyliw, Rex</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   Richard Hansen, Martin Hoffmann, Paul Hoffman, Fabian Holler, Russ</td><td> </td><td class="rblock">   Fernando, Richard Hansen, Martin Hoffmann, Paul Hoffman, Fabian</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   Housley, Claudio Jeker, Pradosh Mohapatra, Keyur Patel, David</td><td> </td><td class="rblock">   Holler, Russ Housley, Claudio Jeker, Pradosh Mohapatra, Keyur Patel,</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="lblock">   Mandelberg, Sandy Murphy, Robert Raszuk, Andreas Reuter, Thomas</td><td> </td><td class="rblock">   David Mandelberg, Sandy Murphy, Robert Raszuk, Andreas Reuter, Thomas</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Schmidt, John Scudder, Job Snijders, Ruediger Volk, Matthias</td><td> </td><td class="right">   Schmidt, John Scudder, Job Snijders, Ruediger Volk, Matthias</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Waehlisch, and David Ward.  Particular thanks go to Hannes Gredler</td><td> </td><td class="right">   Waehlisch, and David Ward.  Particular thanks go to Hannes Gredler</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   for showing us the dangers of unnecessary fields.</td><td> </td><td class="right">   for showing us the dangers of unnecessary fields.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   No doubt this list is incomplete.  We apologize to any contributor</td><td> </td><td class="right">   No doubt this list is incomplete.  We apologize to any contributor</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   whose name we missed.</td><td> </td><td class="right">   whose name we missed.</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">Authors' Addresses</td><td> </td><td class="right">Authors' Addresses</td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left"></td><td> </td><td class="right"></td><td class="lineno"></td></tr>
      <tr><td class="lineno"></td><td class="left">   Randy Bush</td><td> </td><td class="right">   Randy Bush</td><td class="lineno"></td></tr>

     <tr><td></td><td class="left"></td><td> </td><td class="right"></td><td></td></tr>
     <tr id="end" bgcolor="gray"><th colspan="5" align="center">&nbsp;End of changes. 35 change blocks.&nbsp;</th></tr>
     <tr class="stats"><td></td><th><i>91 lines changed or deleted</i></th><th><i> </i></th><th><i>343 lines changed or added</i></th><td></td></tr>
     <tr><td colspan="5" align="center" class="small"><br/>This html diff was produced by rfcdiff 1.45. The latest version is available from <a href="http://www.tools.ietf.org/tools/rfcdiff/" >http://tools.ietf.org/tools/rfcdiff/</a> </td></tr>
   </table>
   </body>
   </html>
